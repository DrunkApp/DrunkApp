!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Comments=t():e.Comments=t()}(this,function(){return function(e){function t(n){if(o[n])return o[n].exports;var c=o[n]={exports:{},id:n,loaded:!1};return e[n].call(c.exports,c,c.exports,t),c.loaded=!0,c.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0;var c=o(1),s=n(c),r=o(2),i=o(3),m=Voonto,a=m.$,u=5e3,d=80,l=7,f=".voc-comments-title",v="comments";Voonto.ready.then(function(e){var t=e.lookup("vocento.config.vocuser.comments.options"),o=e.lookup("vocento.config.vocuser.comments.templatesUrl"),n=[],c=!1;if(!("gigya"in window))throw Error("[Comments] gigya global variable not found");if(!("comments"in gigya))throw Error("[Comments] comments module not fount within gigya");if(a("[data-voc-comments]").each(function(n,c){var s,m,u={};m=a(c),m.one("inview",function(){s=m.data("voc-comments-stream-id"),s&&(a.extend(u,i.DEFAULT_OPTIONS,{streamID:s,containerID:m.attr("id"),cid:m.data("voc-comments-cid"),deviceType:m.data("voc-comments-device-type"),streamTitle:m.data("voc-comments-stream-title"),streamURL:m.data("voc-comments-stream-url"),streamTags:m.data("voc-comments-stream-tags"),enabledShareProviders:m.data("voc-comments-enabled-shared-providers"),useSiteLogin:m.data("voc-comments-use-site-login"),width:m.width(),context:m,onSiteLoginClicked:function(){return e.trigger("vocuser:comments:site-login-clicked",c)},onBeforeCommentSubmitted:function(){return e.trigger("vocuser:comments:before-comment-submitted",c)},onCommentSubmitted:function(){return e.trigger("vocuser:comments:comment-submitted")},onLoad:function(){return e.trigger("vocuser:comments:load")},onError:function(t){return e.trigger("vocuser:comments:error",t)}},t),(0,r.show)(u,{templatesUrl:o,templateName:m.data("voc-comments-template-name")}))})}),a("[data-voc-comments-count]").each(function(e,t){var o=void 0,c=void 0;o=a(t),c=o.data("voc-comments-count"),c&&n.push(c)}),n.length){var s={};a.extend(s,{streamIDs:n,threadLimit:u},t),(0,r.getStreamInfo)(s).then(function(e){e.forEach(function(e){a('[data-voc-comments-count="'+e.streamID+'"]').each(function(){var t,o,n,c,s;t=a(this),n=t.data("voc-comments-count-show-zero"),c=t.data("voc-comments-count-with-literal"),s=t.data("voc-comments-count-zero-text"),o=e.approvedCommentCount,o>0?c?t.html(1===o?o+" comentario":o+" comentarios"):t.html(o):n?t.html(0):s&&t.html(s)})})})}e.on("vocuser:comments:site-login-clicked",function(t,o){e.when("vocuser:ready").then(function(e){var t=a(o).data("voc-comments-section");t&&e.updateCustomerServiceInCookieVocUser("110",t),e.showLogin()})}),e.on("vocuser:comments:before-comment-submitted",function(t,o){var n=a(o).data("voc-comments-section");n&&e.when("vocuser:ready").then(function(e){var t=e.isFirstComment();c&&t&&e.sendCustomerService("110",n).then(function(e){200==e.statusCode&&window.location.reload(!1)})})}),e.on("vocuser:comments:comment-submitted",function(){}),e.one("vocuser:comments:load",function(){var t=document.location.hash.slice("1"),o=t.split("&");o.find(function(e){e===v&&a(f).trigger("click")}),a(".gig-comments-sort").on("click",function(){var e=void 0,t=void 0,o=void 0;e=a(this).offset().top+l+"px",t=a(this).offset().left+d+"px",o=a(".gig-comments-container.gig-comments-sortbox"),o.addClass("gig-comments-sortbox-transition").css({top:e,left:t})}),e.when("vocuser:userdata").then(function(e){var t=e.responseGetUserInfo;0==t.errorCode&&"undefined"!=typeof t&&t&&"undefined"!=typeof t.user.UID&&t.user.UID&&(c=!0),c?a(".gig-composebox-post.voc-send").removeClass("hidden"):a(".gig-composebox-post.voc-send").addClass("hidden")})})});t.VERSION=s.default.version},function(e,t){e.exports={name:"comments",version:"1.2.0",description:"Vocento Comments",main:"src/index.js",scripts:{start:"webpack-dev-server",build:"./node_modules/.bin/webpack"},contributors:["Mikel Balduciel <mbalduciel@atsistemas.com>","Iván Pérez <ivanperez@vocento.com>"],license:"SEE LICENSE IN LICENSE.md",devDependencies:{"babel-core":"^6.17.0","babel-loader":"^6.2.5","babel-preset-es2015":"^6.16.0",case:"^1.4.2",chai:"^3.5.0",chalk:"^1.1.3","html-webpack-plugin":"^2.28.0","js-cookie":"^2.1.3","json-loader":"^0.5.4",mocha:"^3.1.0","mocha-loader":"^1.0.0","parse-url":"^1.3.5",webpack:"^1.13.2","webpack-shell-plugin":"^0.4.3"}}},function(e,t,o){"use strict";function n(e,t){var o=t.templatesUrl,n=t.templateName;n=n||r.DEFAULT_TEMPLATE,Voonto.$.ajax({url:o+"/"+n+".json"}).then(function(t){e.templates=t,gigya.comments.showCommentsUI(e)})}function c(e){return new m.Promise(function(t,o){e.callback=function(e){return t(e.commentCount)},gigya.comments.getComments(e),setTimeout(o,r.REJECT_TIMEOUT)})}function s(e){return new m.Promise(function(t,o){e.callback=function(e){return t(e.streamInfo)},gigya.comments.getStreamInfo(e),setTimeout(o,r.REJECT_TIMEOUT)})}Object.defineProperty(t,"__esModule",{value:!0}),t.show=n,t.getCount=c,t.getStreamInfo=s;var r=o(3),i=Voonto,m=i.RSVP;t.default={show:n,getCount:c,getStreamInfo:s}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.API_VERSION=2;t.DEFAULT_TEMPLATE="default",t.REJECT_TIMEOUT=5e3,t.DEFAULT_OPTIONS=Object.freeze({containerID:"",cid:"",version:o,deviceType:"auto",streamTitle:"",streamURL:"",streamTags:"",enabledSharedProviders:"facebook,twitter,linkedin",lang:"es",useSiteLogin:!0})}])});